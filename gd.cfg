# This is the configuration file for GuardDuty-SOAR.

# ==============================================================================
# GENERAL SETTINGS
# ==============================================================================
[General]
# (STRING) - The desired log level for the application.
#            Allows for dynamic control over logging verbosity.
# OPTIONS: DEBUG, INFO, WARNING, ERROR, CRITICAL
# DEFAULT: INFO
log_level = DEBUG
boto_log_level = WARNING

# ==============================================================================
# EC2 SETTINGS
# ==============================================================================
[EC2]
# (LIST) - A list of EC2-related GuardDuty finding types to ignore.
ignored_findings = 

# (STRING) - The Security Group ID to apply to instances for quarantine.
quarantine_security_group_id = sg-012345abcdefabcde

# (STRING) - The ARN of a managed IAM policy that contains a "Deny All"
#            statement (e.g., {"EFfect": "Deny", "Action": "*", "Resource": "*"}).
#            This policy is attached to a compromised instance's IAM role to
#            immediately revoke its permissions.
iam_deny_all_policy_arn = arn:aws:iam::1234567891234:policy/GuardDuty-SOAR-Deny-All

# (STRING) - The prefix for EBS snapshot descriptions.
snapshot_description_prefix = GD-SOAR-Snapshot-

# (BOOLEAN) - Allow the application to terminate instances.
allow_terminate = True

# (BOOLEAN) - Allow the application to invoke GuardDuty Malware scans.
#allow_malware_scan = True


# (BOOLEAN) - Allow the application to remove public access security group rules.
#           - This is enabled by default. But, if you are using your ec2 instances
#           - as a webserver or some other publicly accessible server, you will want
#           - to disable this. This rule is directly invoked from the finding:
#           - Recon:EC2/PortProbeUnprotectedPort
allow_remove_public_access = True

# ==============================================================================
# IAM SETTINGS
# ==============================================================================
[IAM]
# (INTEGER) - The number of CloudTrail events to retrieve for a principal's history.
#             This value is used by GetCloudTrailHistoryAction
# MIN: 1
# MAX: 50
# DEFAULT: 25
cloudtrail_history_max_results = 25

# (BOOLEAN) - Allow the application to analyze IAM policies attached to finding
#             identity for overly permissive statements (e.g., Action: "*" on Resource: "*")
# DEFAULT: True
analyze_iam_permissions = True


# ==============================================================================
# NOTIFICATIONS
# ==============================================================================
[Notifications]
# --- Simple Email Service (SES) ---
allow_ses = True
registered_email_address = user@example.com

# --- Simple Notification Service (SNS) ---
allow_sns = False
sns_topic_arn = arn:aws:sns:us-east-1:1234567891234:GuardDuty-SOAR-Alerts


